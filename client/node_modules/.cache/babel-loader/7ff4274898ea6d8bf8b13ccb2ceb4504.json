{"ast":null,"code":"import _regeneratorRuntime from\"E:/Axoms course/Module B/Mern Stack Projects/contact-manager/client/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/Axoms course/Module B/Mern Stack Projects/contact-manager/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/Axoms course/Module B/Mern Stack Projects/contact-manager/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useReducer}from'react';import axios from'axios';import authContext from'./authContext';import authReducer from'./authReducer';import setAuthToken from'../../utils/setAuthToken';import{REGISTER_SUCCESS,REGISTER_FAIL,USER_LOADED,LOGIN_SUCCESS,LOGIN_FAIL,LOGINOUT,AUTH_ERROR,CLEAR_ERRORS}from'../types';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthState=function AuthState(props){var initialState={token:localStorage.getItem('token'),//check the user login or not\nisAuthentication:null,// jb page loading hoga tu loading true our jab load ho jaya ga tu ladding false ho jay ga\nloading:true,// jis ko user ko hmna authenticate krna ha\nuser:null,error:null};var _useReducer=useReducer(authReducer,initialState),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];// Register Users\nvar register=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(formData){var config,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0://  we send a formData  in json format so we tell a axios we snd a json data so\n// we define a config that contain the headers\nconfig={headers:{'Content-Type':'application/json'}};_context.prev=1;_context.next=4;return axios.post('/api/users',formData,config);case 4:res=_context.sent;dispatch({type:REGISTER_SUCCESS,payload:res.data});loadedUser();_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](1);dispatch({type:REGISTER_FAIL,payload:_context.t0.response.data.msg});case 12:case\"end\":return _context.stop();}}},_callee,null,[[1,9]]);}));return function register(_x){return _ref.apply(this,arguments);};}();//loaded user\nvar loadedUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(localStorage.token){setAuthToken(localStorage.token);}_context2.prev=1;_context2.next=4;return axios.get('/api/auth');case 4:res=_context2.sent;dispatch({type:USER_LOADED,payload:res.data});_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](1);dispatch({type:AUTH_ERROR});case 11:case\"end\":return _context2.stop();}}},_callee2,null,[[1,8]]);}));return function loadedUser(){return _ref2.apply(this,arguments);};}();//login user\nvar Login=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(formData){var config,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0://  we send a formData  in json format so we tell a axios we snd a json data so\n// we define a config that contain the headers\nconfig={headers:{'Content-Type':'application/json'}};_context3.prev=1;_context3.next=4;return axios.post('/api/auth',formData,config);case 4:res=_context3.sent;dispatch({type:LOGIN_SUCCESS,payload:res.data});loadedUser();_context3.next=12;break;case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);dispatch({type:LOGIN_FAIL,payload:_context3.t0.response.data.msg});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return function Login(_x2){return _ref3.apply(this,arguments);};}();//logout user\nvar Logout=function Logout(){return dispatch({type:LOGINOUT});};// clear errors\nvar clearErrors=function clearErrors(){dispatch({type:CLEAR_ERRORS});};return/*#__PURE__*/_jsx(authContext.Provider,{value:{token:state.token,isAuthentication:state.isAuthentication,loading:state.loading,user:state.user,error:state.error,register:register,clearErrors:clearErrors,loadedUser:loadedUser,Login:Login,Logout:Logout},children:props.children});};export default AuthState;","map":{"version":3,"sources":["E:/Axoms course/Module B/Mern Stack Projects/contact-manager/client/src/context/auth/AuthState.js"],"names":["React","useReducer","axios","authContext","authReducer","setAuthToken","REGISTER_SUCCESS","REGISTER_FAIL","USER_LOADED","LOGIN_SUCCESS","LOGIN_FAIL","LOGINOUT","AUTH_ERROR","CLEAR_ERRORS","AuthState","props","initialState","token","localStorage","getItem","isAuthentication","loading","user","error","state","dispatch","register","formData","config","headers","post","res","type","payload","data","loadedUser","response","msg","get","Login","Logout","clearErrors","children"],"mappings":"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","sourcesContent":["import React, { useReducer } from 'react';\r\nimport axios from 'axios';\r\nimport authContext from './authContext';\r\nimport authReducer from './authReducer';\r\nimport setAuthToken from '../../utils/setAuthToken';\r\nimport {\r\n  REGISTER_SUCCESS,\r\n  REGISTER_FAIL,\r\n  USER_LOADED,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAIL,\r\n  LOGINOUT,\r\n  AUTH_ERROR,\r\n  CLEAR_ERRORS,\r\n} from '../types';\r\n\r\nconst AuthState = (props) => {\r\n  const initialState = {\r\n    token: localStorage.getItem('token'),\r\n    //check the user login or not\r\n    isAuthentication: null,\r\n    // jb page loading hoga tu loading true our jab load ho jaya ga tu ladding false ho jay ga\r\n    loading: true,\r\n    // jis ko user ko hmna authenticate krna ha\r\n    user: null,\r\n    error: null,\r\n  };\r\n\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n  // Register Users\r\n  const register = async (formData) => {\r\n    //  we send a formData  in json format so we tell a axios we snd a json data so\r\n    // we define a config that contain the headers\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n    try {\r\n      const res = await axios.post('/api/users', formData, config);\r\n      dispatch({ type: REGISTER_SUCCESS, payload: res.data });\r\n      loadedUser();\r\n    } catch (err) {\r\n      dispatch({ type: REGISTER_FAIL, payload: err.response.data.msg });\r\n    }\r\n  };\r\n  //loaded user\r\n  const loadedUser = async () => {\r\n    if (localStorage.token) {\r\n      setAuthToken(localStorage.token);\r\n    }\r\n    try {\r\n      const res = await axios.get('/api/auth');\r\n      dispatch({ type: USER_LOADED, payload: res.data });\r\n    } catch (err) {\r\n      dispatch({ type: AUTH_ERROR });\r\n    }\r\n  };\r\n  //login user\r\n  const Login = async (formData) => {\r\n    //  we send a formData  in json format so we tell a axios we snd a json data so\r\n    // we define a config that contain the headers\r\n    const config = {\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n    };\r\n    try {\r\n      const res = await axios.post('/api/auth', formData, config);\r\n      dispatch({ type: LOGIN_SUCCESS, payload: res.data });\r\n      loadedUser();\r\n    } catch (err) {\r\n      dispatch({ type: LOGIN_FAIL, payload: err.response.data.msg });\r\n    }\r\n  };\r\n  //logout user\r\n\r\n  const Logout = () => dispatch({ type: LOGINOUT });\r\n  // clear errors\r\n  const clearErrors = () => {\r\n    dispatch({ type: CLEAR_ERRORS });\r\n  };\r\n\r\n  return (\r\n    <authContext.Provider\r\n      value={{\r\n        token: state.token,\r\n\r\n        isAuthentication: state.isAuthentication,\r\n\r\n        loading: state.loading,\r\n\r\n        user: state.user,\r\n        error: state.error,\r\n        register,\r\n        clearErrors,\r\n        loadedUser,\r\n        Login,\r\n        Logout,\r\n      }}\r\n    >\r\n      {props.children}\r\n    </authContext.Provider>\r\n  );\r\n};\r\nexport default AuthState;\r\n"]},"metadata":{},"sourceType":"module"}